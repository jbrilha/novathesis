\section{Decentralized Synchronization and Time Coordination}
\label{sec:decentralized_sync}

Multi-channel communication strategies, particularly those that employ
coordinated channel hopping for security or efficiency reasons, require nodes
to maintain synchronized clocks. Without time synchronization, devices cannot
agree on when to switch channels, rendering coordinated multi-protocol
operation impossible.

Traditional master-based synchronization approaches -- where a designated
coordinator is responsible for communicating timing signals -- once more fall
into the trap of having a single point of failure in that same master node:
should it fail, the entire network becomes susceptible to losing accurate
temporal reference, leading to the collapse of any coordination efforts.

This is a notorious challenge to overcome when designing distributed systems,
and it becomes more prominent in the disaster scenarios discussed thus far,
where infrastructure failures are likely to eliminate the nodes responsible for
time synchronization in a given system.

Achieving robust time synchronization in such situations requires fully
decentralized approaches that eliminate central coordinator dependencies while
still remaining sufficiently lightweight to be executed on resource-constrained
platforms.

\subsection{Master-Based Synchronization as Counterexample}
\label{subsec:master_sync}

As discussed in Section~\ref{subsec:multi-channel}, the MCSC-WoT
framework~\cite{mcsc-wot} demonstrates a security-focused multi-channel hopping
approach aimed at embedded platforms, but with a fundamental dependency on a
master node broadcasting synchronization signals.

This approach uses a shared \gls{PRNG} seed to generate channel-hopping sequences,
with the master node broadcasting periodic synchronization beacons that slave
nodes use to compensate for clock drift. Nodes that lose synchronization
altogether can rejoin by hopping to a random channel and waiting for the next
master beacon.

While the proposed goals were achieved in terms of minimizing energy
expenditure and maintaining \gls{FHSS} patterns, it inherits the fundamental
limitation of all master-based approaches mentioned at the start of
Section~\ref{sec:decentralized_sync}. If the master fails or becomes unreachable,
participating nodes gradually drift out of synchronization until coordinated
channel hopping is no longer possible.

The system's clock drift compensation algorithm demonstrates the feasibility of
synchronization on ESP32 platforms, and their measured \gls{AES} encryption
performance validates that lightweight security can coexist with time
synchronization on resource-constrained devices. However, the architectural
dependency on a central coordinator fundamentally conflicts with
infrastructure-independent operation requirements we aim to fulfill.

\subsection{Gossip-Based Masterless Synchronization}
\label{subsec:gossip_sync}

Decentralized time synchronization eliminates coordinator dependencies by
having nodes reach consensus on clock values through distributed local
interactions. Two complementary approaches demonstrate the viability of
gossip-based synchronization for wireless sensor networks.\todo{mau usar WSN aqui?}

The \gls{RGCS} algorithm proposed
in~\cite{rgcs2018} addresses time synchronization in dynamic \glspl{WSN} through
randomized asynchronous gossip. Each node maintains a logical clock (T)
composed of rate ($\alpha$) and offset ($\beta$) parameters, which together transform the
node's hardware clock ($\tau$) into synchronized logical time.

Rather than requiring fixed communication links between specific node pairs
which might be fragile in dynamic topologies, their approach uses Poisson-based
randomized link activation where each potential synchronization link activates
with intensity $\lambda$.

The synchronization process operates through pairwise gossip exchanges: when a
link activates, the triggering node sends a Sync-L beacon selecting a triggered
neighbor, followed by bidirectional exchange of multivariable messages
containing each node's current logical clock parameters [$\alpha, \beta, \tau$].

The asynchronous randomized timing of these exchanges is advantageous in that
collision rates drop to near zero compared to 19-23\% for deterministic
communication protocols, as independent Poisson intervals make simultaneous
transmissions to the same receiver statistically unlikely.

The proposed \gls{RGCS} employs a converge-to-max criterion rather than average-value
consensus. This maximum-based approach achieves finite time convergence
significantly faster than average-based protocols that require many iterations
to converge under significant clock drift. Offset compensation follows suit,
with nodes adjusting $\beta$ parameters based on the difference between their
and the neighbors' logical clocks.

Bounded communication delays are handled through a least-square estimation
low-pass filter.\todo{n√£o sei se sei explicar este low-pass filter, vale a
	pena?} This addresses the realistic concern of uplink and downlink delays
differing, and avoids the symmetric delay assumptions made by many theoretical
protocols. The filter's weighing parameter decreases over time, in order to
restrain the negative effects of additive noise in stochastic approximation.

Storage complexity remains O($|N_i|$) per node per iteration (proportional only
to the number of neighbors, not network size) thus ensuring scalability. The
protocol simultaneously compensates both clock rate and offset, unlike
approaches that handle these separately and thus require additional convergence
time.

\subsection{Coordination Through Passive View Maintenance}
\label{subsec:coord_passive}

As discussed in Section~\ref{subsec:peer_disc}, the shuffle-based passive view
maintenance presented in HyParView~\cite{hyparview2007} provides a
complementary coordination mechanism. While primarily designed for topology
management, the periodic shuffle operations in which nodes exchange lists of
known peers can also serve the purpose of propagating network membership
information that can inform synchronization decisions.

Nodes performing shuffle exchanges already communicate periodically; these same
communication windows can opportunistically carry synchronization messages
(piggybacking), reducing protocol overhead. The passive view serves as a pool
of potential sync partners, so that when a node's active sync neighbors become
unreachable, it can initiate sync exchanges with passive view members,
providing added resilience to topology changes without requiring global network
knowledge.

\subsection{Implications for \textbf{\gls{ubabel}}}
\label{subsec:microbabel_implications_3}

Master-based synchronization approaches like MCSC-WoT~\cite{mcsc-wot}
demonstrate feasibility on ESP32 platforms with measured AES encryption
coexistence, but create single points of failure when master nodes become
unreachable.

\gls{RGCS}~\cite{rgcs2018} eliminates coordinator dependencies, and provides
converge-to-max synchronization with Poisson-based randomized gossip that
achieves near-zero collision rates with just O($|N_i|$) storage complexity per
node. However, it assumes homogeneous single-protocol networks where all nodes
use the same communication medium with identical energy characteristics and
range properties.

HyParView's~\cite{hyparview2007} shuffle-based passive view maintenance
provides complementary coordination through periodic peer exchanges that could
carry piggybacked sync messages, but was not designed for time synchronization
integration.\\

No existing work addresses decentralized time synchronization across
heterogeneous multi-protocol networks where different communication
technologies (\gls{BLE}, \gls{LoRa}, Wi-Fi) have distinct energy costs, range,
and reliability properties that warrant protocol-specific gossip rates.

\textbf{\gls{ubabel}}'s approach (Section~\ref{subsec:microbabel_approach_3})
must extend \gls{RGCS} to multi-protocol scenarios with per-protocol Poisson
processes while guaranteeing and preventing protocol selection oscillations
during sync events.

\subsection{MicroBabel's Approach}
\label{subsec:microbabel_approach_3}

While MCSC-WoT demonstrates master-based synchronization feasibility and
\gls{RGCS} provides masterless convergence, both assume homogeneous
single-protocol networks.

\textbf{\gls{ubabel}} will extend \gls{RGCS} to heterogeneous multi-protocol
networks through protocol-specific Poisson processes with distinct activation
rates. Rather than a single $\lambda$ controlling overall sync frequency, the
system employs per-protocol gossip rates that take into account the energy
required for each transmission, and the current network conditions:

\begin{description}
	\item \textbf{$\lambda$\_\gls{BLE}} (high frequency): provides rapid local
	      synchronization with nearby neighbors, leveraging \gls{BLE}'s low energy cost
	      for frequent exchanges
	\item \textbf{$\lambda$\_\gls{LoRa}} (low frequency): maintains long-range
	      temporal coordination, using \gls{LoRa}'s more expensive transmissions
	      sparingly
	\item \textbf{$\lambda$\_Wi-Fi} / Others (medium frequency): situational
	      use based on network density, energy budgets and other factors
\end{description}

Each protocol will have its own Poisson-triggered gossip loop, but all updates
contribute to a single shared logical clock via the converge-to-max criterion
explored above. When sync events from different protocols occur
near-simultaneously, the max operation's associativity ensures correct
convergence regardless of update order.

This multi-graph gossip approach provides several advantages over homogeneous
sync:
\begin{description}
	\item \textbf{Faster convergence:} High-frequency \gls{BLE} gossip can achieve
	      tighter local consensus while sparse \gls{LoRa} exchanges prevent drift
	      between distant clusters. The combination converges faster than either
	      protocol alone.
	\item \textbf{Resilience through diversity:} If 2.4 GHz interference
	      disrupts \gls{BLE}/Wi-Fi synchronization, \gls{LoRa} maintains loose temporal
	      coordination across the network. Conversely, if \gls{LoRa} experiences poor
	      conditions, local \gls{BLE} sync keeps nearby nodes coordinated.
	\item \textbf{Natural energy optimization:} Protocol characteristics
	      directly inform sync frequencies, so that more expensive long-range
	      transmissions occur rarely while cheap short-range exchanges happen
	      frequently, matching energy budgets to communication needs.
\end{description}

The \gls{hysteresis} control mechanisms adapted from
Section~\ref{sec:multi_protocol} will prevent oscillations in protocol
selection during sync events: sync partner and protocol choices stabilize
around locally optimal configurations rather than continuously switching
between equally-viable options.

The approach aims to handle network partitions gracefully: nodes maintain
synchronization within their reachable partition using available protocols, and
when partitions merge (through mobility or topology changes), the
converge-to-max criterion naturally reconciles previously independent temporal
references without requiring special merge logic.

Unlike MCSC-WoT's master-based approach, this architecture will operate in a
fully \gls{P2P} fashion with no fixed coordinator dependencies. The
multi-protocol extension goes beyond \gls{RGCS}'s original homogeneous network
assumptions, since heterogeneous gossip graphs with protocol-specific
characteristics warrant distinct sync frequencies, enabling simultaneous
optimization of convergence speed, energy consumption, and range coverage.
